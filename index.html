<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ค้นหาข้อมูล</title>
</head>
<body>
  <h2>ค้นหาข้อมูลด้วยอีเมล</h2>
  <input type="text" id="emailInput" placeholder="กรอกอีเมล">
  <button onclick="searchData()">ค้นหา</button>
  <p id="result"></p>

  <script>
    async function searchData() {
      const email = document.getElementById("emailInput").value.trim().toLowerCase();
      const resultDiv = document.getElementById("result");

      if (!email) {
        resultDiv.textContent = "โปรดใส่อีเมลในช่องนี้";
        return;
      }

      const apiUrl = "https://script.google.com/macros/s/AKfycbx2OTJ4z3NsRUD64d_-RlNuiSpwk4hdgzHlYCtuBgzXmXOPJ_Wb3bMy1tMVU90YmNUr/exec?email=" + encodeURIComponent(email);

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();

        if (data.results.length > 0) {
          resultDiv.innerHTML = data.results.map(row =>
            `<div>
              <strong>ชื่อไลน์:</strong> ${row.lineName}<br>
              <strong>อีเมล:</strong> ${row.email}<br>
              <strong>วันที่เข้า:</strong> ${row.entryDate}<br>
              <strong>วันหมดอายุ:</strong> ${row.expiryDate}
            </div>`
          ).join("<hr>");
        } else {
          resultDiv.textContent = "ไม่พบข้อมูล";
        }
      } catch (error) {
        console.error("เกิดข้อผิดพลาดในการดึงข้อมูล:", error);
        resultDiv.textContent = "เกิดข้อผิดพลาดในการดึงข้อมูล";
      }
    }
  </script>
</body>
</html>
